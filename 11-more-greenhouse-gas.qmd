---
title: "Increasing greenhouse gases"
format: 
  revealjs:
    code-fold: false
    theme: white
    footer: "GEO4251 Climate Change & Storms"
    chalkboard: true
---

##

-   How climate change works
-   Plotting greenhouse gas data (historical and current)
-   Emissions data

## 

-   How climate change works

{{< video https://www.youtube.com/embed/CGoNpwN0mrs >}}

##

-   A greenhouse gas (GHG) is air that absorbs and emits radiant energy within the thermal (infrared) range, causing the greenhouse effect
-   The primary greenhouse gases in Earth's atmosphere are water vapor (H~2~O), carbon dioxide (CO~2~), methane (CH~4~), nitrous oxide (N~2~O), and ozone (O~3~)
-   Without greenhouse gases, the average temperature at the ground would be about −18°C (0°F)
-   With greenhouse gases it is 15°C (59°F)

##

-   Humans have increased the concentration of carbon dioxide in the air by more than 50% since the Industrial Revolution
-   280 ppm in 1750 to 421 ppm in 2022
-   Last time carbon dioxide was this high was 3 million years ago
-   The vast majority of anthropogenic carbon dioxide comes from burning fossil fuels, coal, petroleum, and natural gas
-   Other contributions are from cement making, fertilizer production, deforestation

##

-   How CO~2~ travels around the world

<https://svs.gsfc.nasa.gov/vis/a010000/a011700/a011719/> 3 minutes

## 

-   Carbon dioxide (CO~2~) data from NOAA

<https://gml.noaa.gov/ccgg/trends/data.html>

```{r, message=FALSE}
#| echo: true
co2.df <- readr::read_table(file = here::here("data", "co2_mm_mlo.txt")) |>
  dplyr::select(Year, Month, CO2_ppm) |>
  dplyr::mutate(Date = paste("01", month.abb[Month], Year)) |>
  dplyr::mutate(Date = as.Date(Date, format = "%d %b %Y"))

co2.df |>
  head()
```

##

```{r}
#| echo: true
library(ggplot2)

ggplot(data = co2.df,
       mapping = aes(x = Date, y = CO2_ppm)) +
  geom_line()
```

-   Add a smooth line through the monthly values

## 

-   Methane (CH~4~) data from NOAA 

<https://gml.noaa.gov/webdata/ccgg/trends/ch4/ch4_mm_gl.txt>

```{r, message=FALSE}
#| echo: true
ch4.df <- readr::read_table(file = here::here("data", "ch4_mm_gl.txt")) |>
  dplyr::select(Year, Month, CH4_ppb) |>
  dplyr::mutate(Date = paste("01", month.abb[Month], Year)) |>
  dplyr::mutate(Date = as.Date(Date, format = "%d %b %Y"))

ch4.df |>
  head()
```

##

```{r}
#| echo: true
ggplot(data = ch4.df,
       mapping = aes(x = Date, y = CH4_ppb)) +
  geom_line() +
  geom_smooth()
```

<https://www.climate.gov/news-features/understanding-climate/after-2000-era-plateau-global-methane-levels-hitting-new-highs>

## {.smaller}

-   The package {hockeystick} has functions that make climate data easily available
-   You download the latest data from authoritative sources and make pre-defined plots
-   The name of the package stems from the well-known [hockey stick](https://en.wikipedia.org/wiki/Hockey_stick_graph) temperature chart

-   Select the Packages tab then Install and search for `hockeystick`
-   Or use the following code chunk
```{r}
#| echo: true
install.packages("hockeystick",
                 repo = "https://cloud.r-project.org")
```

## 

-   Get the latest CO~2~ data
-   Download the CO~2~ data using the `get_carbon()` function from the {hockeystick} package
-   The data are atmospheric CO~2~ measurements at Mauna Loa Observatory, Hawaii

```{r}
#| echo: true
library(hockeystick)

co2.df2 <- hockeystick::get_carbon(write_cache = TRUE)
```

## 

Take a look at the first six rows of the data frame using the `head()` function

```{r}
#| echo: true
co2.df2 |>
  head()
```

## 

-   Make a time series plot

```{r}
#| echo: true
hockeystick::plot_carbon(co2.df2)
```

## 

```{r}
#| echo: true
( co2.df3 <- co2.df2 |>
  dplyr::rename(CO2_ppm = average) |>
  dplyr::mutate(Year = lubridate::year(date),
                Month = lubridate::month(month, label = TRUE)) |>
  dplyr::select(Year, Month, CO2_ppm) )
```

## 

-   Seasonal change

```{r}
#| echo: true
#| output-location: slide 
#| fig-cap: "Seasonal change in carbon dioxide at Mauna Loa"
co2.df3 |>
  dplyr::group_by(Month) |>
  dplyr::summarize(Avg_ppm = mean(CO2_ppm)) |>
  ggplot(mapping = aes(x = Month, y = Avg_ppm)) +
    geom_point() +
    geom_line() +
    ylab("Parts per million") 
```

## 

-   Get the emissions data
-   Download the emissions data using the `get_emissions()` function from the {hockeystick} package
-   Look at the first six rows of the data frame using the `head()` function

```{r}
#| echo: true
emits.df <- hockeystick::get_emissions(write_cache = TRUE)

emits.df |>
  head()
```

## 

-   Make a time-series plot

```{r}
#| echo: true
#| fig-cap: "Annual total emissions worldwide"
emits.df |>
  hockeystick::plot_emissions()
```

## 

-   Total CO~2 emission by country/region in 2020

```{r}
#| echo: true
emits.df |>
  dplyr::filter(year == 2020) |>
  dplyr::select(country, co2, co2_per_capita) |>
  dplyr::arrange(desc(co2))
```

China, United States, India, Russia, Japan, Iran, Germany, Saudi Arabia, South Korea, Indonesia, Canada, Brazil, South Africa, Turkey, Australia, United Kingdom, Italy, Poland, Kazakhstan, France, Taiwan, Malaysia

## 

-   Total CO~2 per person by country/region in 2020

```{r}
#| echo: true
emits.df |>
  dplyr::filter(year == 2020) |>
  dplyr::select(country, co2, co2_per_capita) |>
  dplyr::arrange(desc(co2_per_capita))
```

##

-   Compare emissions between the U.S. and China
-   What do you expect?

```{r}
#| echo: true
df <- emits.df |>
  dplyr::filter(country %in% c("China", "United States"),
                year >= 1910) |>
  dplyr::select(country, year, co2, co2_per_capita)
```

```{r}
#| echo: true
ggplot(data = df,
       mapping = aes(x = year, y = co2, color = country)) +
  geom_line()
```

##

-   Your turn. Repeat this graph with the co2_per_capita variable
-   What do you expect?

## 

-   A tornado season forecast for 2023

{{< video https://www.youtube.com/embed/5kVeEf7CtCE >}} 8 minutes
