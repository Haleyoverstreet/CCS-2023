---
title: "Quantifying changes over time"
format: 
  revealjs:
    code-fold: false
    theme: simple
    footer: "GEO4251 Climate Change & Storms"
    chalkboard: true
editor: source
---

## 

-   Lab 2, next Monday (February 13)
-   Material from Lessons 7 & 8
-   Today
    -   Quantifying changes over time
    -   Tornadoes up close: Storm chasing escapades of Pecos Hank

## 

-   Returning to the monthly rain data from Northwest Florida
-   Get the data into your current R session as a data frame with name `Rain.df`
-   Select the columns labeled `Year` and `Jun`
-   Add a column (`dplyr::mutate()`) with June rain values in centimeters

```{r}
#| echo: true
Rain.df <- readr::read_table(here::here("data", "NWFL_MonthlyRain.txt")) |>
  dplyr::select(Year, Jun) |>
  dplyr::mutate(Rain_cm = Jun * 2.54)
```

-   `View(Rain.df)`

## 

-   Make a time series graph showing the June rainfall values over the years

```{r}
#| echo: true
library(ggplot2)

ggplot(data = Rain.df,
       mapping = aes(x = Year, y = Rain_cm)) +
  geom_line()
```

## 

-   Include a line that shows the smoothed changes over time

```{r}
#| echo: true
ggplot(data = Rain.df,
       mapping = aes(x = Year, y = Rain_cm)) +
  geom_line() +
  geom_smooth()
```

-   There appears to be a tendency for more rain in June now than in the past
-   The change is almost linear

## 

-   To make the blue line straight, you change the default local regression smoother
-   You do this by including the argument `method = lm` inside the `geom_smooth()` function

```{r warning=FALSE, message=FALSE}
#| echo: true
ggplot(data = Rain.df,
       mapping = aes(x = Year, y = Rain_cm)) +
  geom_line() +
  geom_smooth(method = lm)
```

## 

-   The slope of the blue line is the average amount of change over the years
-   You quantify this change using the following code

```{r}
#| echo: true
lm(Rain_cm ~ Year, data = Rain.df)
```

-   The value below `Year` is the increase in the amount of rain in centimeters per year
-   +.023 cm per year or +2.3 cm per 100 years
-   Convert to inches?

## 

-   Temperature is a key climate indicator
-   Measurements made on land and in water across the globe indicate how temperature has changed over years, decades and centuries
-   They also tell us how temperature varies from one place to another
-   Global temperature is an aggregate over all the local temperatures
-   It summarizes the overall tendency in surface air temperature
-   It is the longest instrumental series of global climate change that we have

## 

-   Global temperature data from various research labs <https://climate.metoffice.cloud/temperature.html>
-   Annual global mean temperatures expressed as a difference from pre-industrial conditions (anomalies)
-   Four data sets are available and there is a large agreement between them
-   Temperature anomalies are calculated relative to a 1981 to 2010 baseline and offset by .69°C, which is the best estimate difference for that period from the 1850-1900 average given in the IPCC sixth assessment report

## 

-   Global mean temperature from the Climatic Research Unit
-   A leading institution concerned with the study of natural and anthropogenic climate change

```{r}
#| echo: true
L <- "https://climate.metoffice.cloud/formatted_data/gmt_HadCRUT5.csv"
download.file(url = L,
              destfile = here::here("data", "T.csv"))

T.df <- readr::read_csv(here::here("data", "T.csv"),
                        show_col_types = FALSE)
names(T.df) <- c("Year", "T_C", "u")

T.df |>
  head()
```

##  {.smaller}

-   Create a time series graph of the temperature anomalies. Include a ribbon indicating the uncertainty around the estimated values

```{r}
#| echo: true
ggplot(data = T.df,
       mapping = aes(x = Year, y = T_C, ymin = T_C-u, ymax = T_C+u)) +
  geom_ribbon(fill = "gray") + 
  geom_line() +
  scale_x_continuous(breaks = seq(1860, 2020, 20)) + ylab("°C")
```

## 

-   Overall, average temperatures have increased in most areas since the start of the 20th Century. This is reflected in the long-term increase in global temperature
-   However, temperatures have not increased at the same rate everywhere
-   Some general patterns of warming are to be noted: the land has generally warmed faster than the oceans; and over the past two decades, the Arctic has warmed twice as fast as the rest of the world

## 

-   The increase in global temperatures is not steady
-   Slight cooling until about 1920 followed by a warming until the mid 1940s
-   No warming from mid 1940s until the late 1970s
-   Nearly linear warming since then
-   These variations in the rate of warming/cooling can be illustrated using a local smoother

## 

```{r}
#| echo: true
#| code-line-numbers: "4"
ggplot(data = T.df,
       mapping = aes(x = Year, y = T_C)) +
  geom_line() +
  geom_smooth(span = .5, se = FALSE) +
  scale_x_continuous(breaks = seq(1860, 2020, 20)) +
  ylab("°C")
```

## 

-   Let's re-plot the annual temperatures starting in 1973 and then add a trend line

```{r}
#| echo: true
T.df |>
  dplyr::filter(Year >= 1973) |>
ggplot(mapping = aes(x = Year, y = T_C)) +
  geom_line() +
  geom_smooth(method = lm, se = FALSE) +
  scale_x_continuous(breaks = seq(1980, 2020, 10)) +
  ylab("°C")
```

## 

-   The slope of the blue line is the average increase in temperatures over the years
-   You quantify this change using the following code

```{r}
#| echo: true
lm(T_C ~ Year, data = T.df[T.df$Year >= 1973, ])
```

-   The value below `Year` is the increase in temperature in °C per year
-   +.019°C per year or about +1.9°C per 100 years

## 

Pecos Hank and his storm chasing escapades in 2022

{{< video https://www.youtube.com/embed/JtXPVxxiXqk >}} 17 minutes
